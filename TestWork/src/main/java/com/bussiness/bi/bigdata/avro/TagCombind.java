package com.bussiness.bi.bigdata.avro;

import com.alibaba.fastjson.JSONObject;
import com.cqx.common.utils.file.FileCount;
import com.cqx.common.utils.file.FileUtil;
import com.cqx.common.utils.kafka.GenericRecordUtil;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.io.IOException;
import java.util.HashMap;
import java.util.Map;

/**
 * 标签大宽表avro测试
 *
 * @author chenqixu
 */
public class TagCombind {
    private static final Logger logger = LoggerFactory.getLogger(TagCombind.class);

    public void readFile(final String dataPath, final String dataSplit, String schemaPath) throws IOException {
        FileUtil fileUtil = new FileUtil();

        final String topic = "tag_combind";
        final String[] fields = {"user_id",
                "total_fee",
                "total_mou",
                "total_flux",
                "is_high_value_user",
                "lowest_amt",
                "is_arrears_user",
                "oweing_amt",
                "is_owe_recovery_user",
                "is_pay_relationship_user",
                "is_flux_overpkg",
                "is_voice_overpkg",
                "account_balance",
                "is_wechat_focus_user",
                "is_8min_pay_user",
                "is_wechat_pay_user",
                "is_paid_by_others",
                "abncard_gotone_val_lvl",
                "is_three_non_user",
                "is_happy_pkg_no",
                "is_good_value1_no",
                "is_good_value5_no",
                "is_good_value9_no",
                "is_edu_pkg_no",
                "is_live_pkg_no",
                "is_gold_pkg_no",
                "is_platinum_pkg_no",
                "is_net_hall_user",
                "is_wap_hall_user",
                "is_term_ser_user",
                "is_oldterm_ser_user",
                "is_newterm_ser_user",
                "is_mobile_hall_user",
                "bm_user_version",
                "is_bm_new_1d_user",
                "is_bm_new_mtd_user",
                "is_wechat_new_b_1d_user",
                "is_wechat_new_b_mtd_user",
                "is_wechat_new_fb_1d_user",
                "is_wechat_new_fb_mtd_user",
                "is_net_hall_new_1d_user",
                "is_net_hall_new_mtd_user",
                "is_wap_hall_new_1d_user",
                "is_wap_hall_new_mtd_user",
                "is_term_new_1d_user",
                "is_term_new_mtd_user",
                "is_oldterm_new_1d_user",
                "is_oldterm_new_mtd_user",
                "is_newterm_new_1d_user",
                "is_newterm_new_mtd_user",
                "is_mobile_new_1d_user",
                "is_wechat_act_1d_user",
                "is_wechat_zd_act_1d_user",
                "is_wechat_zd_act_mtd_user",
                "is_wechat_zd_act_3mtd_user",
                "is_net_act_1d_user",
                "is_net_act_mtd_user",
                "is_net_act_3mtd_user",
                "is_wap_act_1d_user",
                "is_wap_act_mtd_user",
                "is_wap_act_3mtd_user",
                "is_term_act_1d_user",
                "is_term_act_mtd_user",
                "is_term_act_3mtd_user",
                "is_oldterm_act_1d_user",
                "is_oldterm_act_mtd_user",
                "is_oldterm_act_3mtd_user",
                "is_newterm_act_1d_user",
                "is_newterm_act_mtd_user",
                "is_newterm_act_3mtd_user",
                "is_mobile_act_1d_user",
                "is_mobile_act_mtd_user",
                "is_mobile_act_3mtd_user",
                "is_sms_act_1d_user",
                "is_sms_act_mtd_user",
                "is_sms_act_3mtd_user",
                "is_bm_zd_act_mtd_user",
                "is_bm_zd_act_3mtd_user",
                "is_bm_dnzd_act_mtd_user",
                "is_bm_dnzd_act_3mtd_user",
                "is_wechat_hall_fb_user",
                "is_happy_pkg_no2m",
                "is_good_value1_no2m",
                "is_good_value3_no2m",
                "is_good_value5_no2m",
                "is_good_value9_no2m",
                "is_edu_pkg_no2m",
                "is_live_pkg_no2m",
                "is_gold_pkg_no2m",
                "is_platinum_pkg_no2m",
                "is_5g_zhixiang_pkg_no",
                "is_5g_zhitong_pkg_no",
                "is_happy_pkg_pref",
                "is_good_value1_pref",
                "is_good_value3_pref",
                "is_good_value5_pref",
                "is_good_value9_pref",
                "is_edu_pkg_pref",
                "is_live_pkg_pref",
                "is_gold_pkg_pref",
                "is_platinum_pkg_pref",
                "is_rights_platinum_no",
                "is_province_roam_user",
                "is_internation_roam_user",
                "mob_age",
                "is_family_guard",
                "is_5g_terminal_user",
                "terminal_manufact",
                "net_type",
                "is_cust_terminal",
                "terminal_type",
                "is_intelligent",
                "bingding_leave_month",
                "bingding_total_month",
                "is_camera_user",
                "is_door_lock_user",
                "is_new_5g_terminal",
                "is_5g_ter_non_pack_user",
                "switch_of_5g",
                "is_chng_term_potential",
                "is_ajjk_order_user",
                "is_ajjk_bind",
                "is_ajjk_active",
                "is_5g_terminal_d_user",
                "is_safe_tml",
                "is_jk_tml",
                "is_remote_tml",
                "is_speaker_tml",
                "is_yun_order",
                "is_safe_alarm_order",
                "is_remote_order",
                "is_speaker_order",
                "is_5g_terminal_sa_up",
                "is_nfc_terminal_d",
                "is_diff_master_str",
                "is_5g_term_net_user",
                "is_prov_roam",
                "students_type",
                "is_in_resident_school",
                "is_in_res_2020_new_school",
                "home_county",
                "msisdn",
                "customer_id",
                "brand_id",
                "user_brand",
                "user_type",
                "service_status",
                "is_mac_card",
                "join_channel",
                "create_time",
                "star_level",
                "home_city",
                "product_ids",
                "orgpath",
                "is_cd_photo_user",
                "is_6_industry_user",
                "is_committee_photo_user",
                "is_pan_hotel_user",
                "is_community_photo_user",
                "is_logistics_photo_user",
                "is_retire_photo_user",
                "is_shop_photo_user",
                "is_family_share_user",
                "is_group_user",
                "is_region_user",
                "is_senior_user",
                "is_home_key_user",
                "is_user_status",
                "is_up_brand_user",
                "is_no_market_user",
                "is_wlw_user",
                "is_old_wap",
                "net_months",
                "is_itv_user",
                "is_4g_net_user",
                "is_limit",
                "newgotone_mark",
                "is_family_user",
                "broadband_user_type",
                "family_cnt",
                "group_id",
                "is_broadband_user",
                "is_group_broadband",
                "is_unlimit_user",
                "is_family_he_subcard",
                "is_intel_network",
                "is_focu_fjyd_wechat",
                "age",
                "is_back_cust",
                "is_familiar_cust",
                "is_nid_in_user",
                "is_nid_out_operator",
                "is_nid_in_time",
                "is_red_cust",
                "is_local_city_ic",
                "is_fj_prov_ic",
                "value_level",
                "group_key_type",
                "grid_name",
                "is_can_xhzw",
                "is_pause_user",
                "is_n_change_package",
                "basic_fee",
                "real_birthday",
                "gender",
                "is_elder",
                "is_unlimited_basic_user",
                "real_birthday_monthday",
                "is_newgotone_user",
                "is_fj_user",
                "is_ele_gray_user",
                "total_score",
                "annual_total_score",
                "is_below_3_idcard",
                "is_decline_call_user",
                "itv_user_name",
                "finish_time",
                "box_type",
                "user_tv_type",
                "is_high_box",
                "data_arpu",
                "is_new_user_m",
                "is_new_user_lm",
                "is_new_user_y",
                "is_new_user_ly",
                "is_watching",
                "tv_name",
                "channel_name",
                "itv_chnl_type",
                "itv_payment_type",
                "complaint_user",
                "itv_payment_user_id",
                "itv_home_city",
                "month_main_chnl",
                "org_fav_lev_id",
                "ele_fav_lev_id",
                "first_class_17_18_user",
                "first_class_19_user",
                "golden_rooster_dianbo_user",
                "golden_rooster_zhibo_user",
                "voice_pop_up_nz_user",
                "itv_ott_status",
                "itv_home_county",
                "first_class_20_user",
                "is_low_model",
                "last_login_time",
                "itv_active_1m",
                "itv_active_2m",
                "itv_active_3m",
                "itv_active_4m",
                "itv_active_5m",
                "itv_active_6m",
                "itv_active_12m",
                "silence_m",
                "is_broad_silence",
                "itv_active_cnt",
                "is_act_movie_30",
                "is_act_tv_30",
                "is_act_show_30",
                "is_act_sports_30",
                "is_act_children_30",
                "is_act_comic_30",
                "is_act_edu_30",
                "is_act_music_30",
                "is_act_game_30",
                "is_act_elect_sports_30",
                "is_act_report_30",
                "is_act_life_30",
                "is_act_5g_30",
                "is_act_movie_90",
                "is_act_tv_90",
                "is_act_show_90",
                "is_act_sports_90",
                "is_act_children_90",
                "is_act_comic_90",
                "is_act_edu_90",
                "is_act_music_90",
                "is_act_game_90",
                "is_act_elect_sports_90",
                "is_act_report_90",
                "is_act_life_90",
                "is_act_5g_90",
                "is_prefer_time",
                "is_prefer_7_9",
                "is_prefer_9_12",
                "is_prefer_12_14",
                "is_prefer_14_18",
                "is_prefer_18_23",
                "is_prefer_23_1",
                "is_prefer_1_7",
                "is_prefer_chnl_top1",
                "is_prefer_chnl_top2",
                "is_prefer_chnl_top3",
                "is_use_children_apk_90",
                "is_use_edu_apk_90",
                "is_use_music_apk_90",
                "is_use_game_apk_90",
                "is_use_elect_sp_apk_90",
                "is_use_life_apk_90",
                "is_use_com_apk_90",
                "is_vedio_effect",
                "is_sports_effect",
                "is_children_effect",
                "is_comic_effect",
                "is_edu_effect",
                "is_life_effect",
                "is_music_effect",
                "is_game_effect",
                "is_elect_sports_effect",
                "is_expire_itv_user",
                "is_2021_first_class",
                "european_cup_user",
                "is_olympic_user",
                "sale_leave_month",
                "sale_cnt",
                "is_terminal_contract",
                "is_optimal_contract",
                "is_prestored_contract",
                "is_guarantee_contract",
                "is_broadband_contract",
                "is_gprs_contract",
                "is_others_contract",
                "is_broadband_user_contract",
                "is_presence_family",
                "is_presence_flow_share",
                "is_presence_payment",
                "is_group_payment",
                "is_group_product",
                "is_flow_expansion",
                "contract_bundle_type",
                "is_no_contract_cus",
                "is_3mon_expire_cus",
                "is_quarter_tar_cus",
                "contract_3m_expire_num",
                "is_no_long_cus",
                "is_3m_expire_cus",
                "is_5g_busi_user",
                "is_5g_unpkg_user",
                "is_5g_128pkg_rec",
                "is_5g_198pkg_rec",
                "is_5g_298pkg_rec",
                "is_5g_unbonspkg_user",
                "is_5g_bonspkg1_rec",
                "is_5g_bonspkg2_rec",
                "is_5g_bonspkg3_rec",
                "is_5g_bonspkg4_rec",
                "prov_od_contract_month",
                "cy_od_contract_month",
                "is_no_guard_od_user",
                "is_5g_basic_user",
                "is_5g_flux_user",
                "is_5g_equity_user",
                "is_with_family_user",
                "is_video_lovers",
                "is_short_video_lovers",
                "is_takeaway_user",
                "is_ecommerce_user",
                "is_card_mkt_user",
                "is_flow_shared_user",
                "is_family_new_user",
                "is_diff_family_group",
                "is_broadband_p_user",
                "is_build_family_aims",
                "is_family_expand_member",
                "prestore_amount",
                "prestore_months",
                "lowest_amount",
                "lowest_amount_months",
                "is_old_family_household",
                "is_bdpkg_not_bd_user",
                "is_sale_mobile",
                "is_pre_user",
                "is_assure_user",
                "is_sale6_mobile",
                "is_pre6_user",
                "is_assure6_user",
                "is_overlay_plan",
                "is_nextm_con_expire",
                "is_nextm_flux_expire",
                "is_nextm_deal_expire",
                "is_nextm_broad_expire",
                "is_nextm_model_expire",
                "is_nextm_optimal_expire",
                "is_nextm_prestored_expire",
                "is_spe_sale",
                "is_5g_feepkg_user",
                "is_contract_user",
                "is_number_no_contract",
                "is_old_user_family",
                "is_msisdn_order_user",
                "is_basedeal_order_user",
                "is_flux_order_user",
                "is_add_order_user",
                "is_equity_order_user",
                "is_cloud_pay_user",
                "is_recom_secdcard",
                "is_recom_sharer",
                "is_recom_shareed",
                "is_recom_craet_fam",
                "is_recom_expand_fam",
                "is_recom_fam",
                "is_recom_go_home",
                "solution_info",
                "sen_type_bus_desk",
                "sen_type_sales_tre",
                "perceive_type",
                "high_comp_cnt",
                "high_urge_cnt",
                "repeat_comp_cnt",
                "deal_gprs_value",
                "deal_gprs_use",
                "is_brand_pro",
                "is_pkg_pro",
                "gprs_data_gsm_rate",
                "gprs_data_td_rate",
                "gprs_data_lte_rate",
                "deal_gprs_basic",
                "deal_gprs_option",
                "comm_flux_rat",
                "is_limit_unpack",
                "is_net_down_user",
                "total_gprs_5g_data",
                "is_flux_user",
                "total_gprs_5g_data_m",
                "is_speedpack_user",
                "is_last_2m_5g_user",
                "over_gprs_fee_m",
                "online_dur_5g",
                "is_flux_potential",
                "is_5g_net_d_user",
                "is_5g_nsa_d_user",
                "is_5g_sa_d_user",
                "lost_p",
                "is_2020_candidate",
                "is_diff_net_fam_user",
                "predicted_prob",
                "predicted_category",
                "impact_factor_large",
                "impact_factor_small",
                "is_only_mobile_card",
                "is_diff_master_card",
                "is_diff_sub_card",
                "is_fam_mem_with_comp",
                "is_diff_family_owner",
                "fam_potential_cnt",
                "fam_potential_brd_cnt",
                "is_hsch_stu",
                "is_two_card_both_user",
                "is_frequency_user",
                "m_login_cnt",
                "is_secretary_user",
                "is_open_volte",
                "is_electronic_bill",
                "is_flow_speed_up",
                "is_group_ring",
                "call_product_name1",
                "call_product_name2",
                "flux_product_name1",
                "flux_product_name2",
                "unlimited_flux_saturation",
                "is_star_move_user",
                "is_national_anime_user",
                "is_wifi_user",
                "total_val_call",
                "total_val_sms",
                "is_birthday_year_user",
                "is_move_star_month_user",
                "is_new_credit_service_user",
                "is_y_national_anime_user",
                "is_enjoy_fam_user",
                "is_share_user",
                "is_share_fam_user",
                "is_fam_attr_user",
                "is_wisdom_fam_user",
                "is_fam_eco_user",
                "is_shop_broad_user",
                "is_shop_share_user",
                "is_shop_eco_user",
                "is_8min_family_user",
                "is_8min_casual_user",
                "is_8min_old_user",
                "is_8min_new_user",
                "is_8min_act_user",
                "is_8min_deeply_act_user",
                "is_8min_3mon_act_user",
                "is_8min_res_broad_user",
                "is_8min_hosting_user",
                "is_8min_mul_card_user",
                "is_wechat_bind",
                "is_wechat_week_active",
                "is_wechat_month_active",
                "is_wechat_3m_active",
                "wechat_no_sign_in",
                "is_visit_bill",
                "bind_no_focus",
                "is_family2_aims",
                "is_iphone_mkt_user",
                "basic_sale_fee",
                "basic_sale_dur",
                "flux_pkg_sale_dur",
                "is_5g_basic_sale_user",
                "is_5g_option_contract",
                "option_discount_fee",
                "is_gur30_user",
                "is_rcv_better_priv",
                "is_rcv_travel_priv",
                "is_rcv_medical_priv",
                "is_rcv_hotel_priv",
                "is_5g_through_car",
                "is_v_network_ten_user",
                "is_family_net_ten_user",
                "is_group_net_ten_user",
                "over_viscosity",
                "is_brb_zero_user",
                "is_subcard_zero_user",
                "is_pan_tml_user",
                "is_group_v_user",
                "is_jan_zero_user",
                "is_mac_card_user",
                "is_hcy_login_user",
                "is_hcy_login_upload_user",
                "is_dp_order",
                "is_dp_expire",
                "is_gold_equity_user",
                "is_platinum_equity_user",
                "is_livesaving_gold",
                "is_livesaving_platinum",
                "is_hema_target_user",
                "is_llms_active_day",
                "is_livesaving_qy_user",
                "is_hcy_act_1m_user",
                "is_hcy_act_2m_user",
                "is_hcy_act_3m_user",
                "is_hcy_act_4m_user",
                "is_hcy_act_5m_user",
                "is_hcy_act_6m_user",
                "is_8min_new_ver_n_user",
                "pay_30_fee",
                "pay_30_cnt",
                "is_first_pay",
                "is_save_money",
                "is_dp_recommend_user",
                "money_lower_next_user",
                "is_cloud_sdk_user",
                "is_8min_8v_user",
                "is_8min_low_user",
                "is_8min_60silent_user",
                "is_10088_regular_user",
                "is_10086_regular_user",
                "is_quarte_10088_user",
                "is_60d_outbound_user",
                "is_high_tencent_user",
                "is_high_iqiyi_user",
                "is_high_youku_user",
                "is_high_mango_user",
                "is_high_bilibili_user",
                "is_high_qqmusic_user",
                "is_high_netease_user",
                "is_high_kugou_user",
                "is_high_himalaya_user",
                "is_high_tiktop_user",
                "is_high_headline_user",
                "is_audio_exp_user",
                "is_youku_300m",
                "is_mangou_300m",
                "is_mogu_video_300m",
                "is_pp_300m",
                "is_tenxun_300m",
                "is_mogu_music_100m",
                "is_mogu_read_100m",
                "is_zhangyue_100m",
                "is_book_flag_100m",
                "is_ximalaya_100m",
                "is_easou_100m",
                "is_qq_music_100m",
                "is_kugou_100m",
                "is_qq_read_100m",
                "is_iqiyi_300m",
                "is_qingting_100m",
                "is_bilibili_300m",
                "is_kuwo_100m",
                "is_wangyi_100m",
                "is_zuoyebang_100m",
                "is_zhihu_100m",
                "is_eleme_100m",
                "is_weiyi_100m",
                "is_qingju_100m",
                "is_access_two_month",
                "enjoy_high_pre",
                "enjoy_mid_pre",
                "enjoy_low_pre",
                "sup_shop_high_pre",
                "sup_shop_mid_pre",
                "sup_shop_low_pre",
                "is_brb_order_user",
                "is_broad_cover",
                "is_fuse_not_broadband",
                "is_school_brd",
                "is_not_bdsale_bduser",
                "product_expire_time",
                "sale_expire_time",
                "broad_product_type",
                "is_mbh_pot_user",
                "is_sec_user",
                "is_5g_wifi_user",
                "is_itv_val_add_user",
                "is_ent_broad_exp_user",
                "is_brd_no_contract",
                "expire_month_dur",
                "is_broad_silence_user",
                "is_expire_no_renew",
                "is_chg_width_user",
                "is_rvc_brd_priv",
                "fam_mem_brd_cnt",
                "fam_mem_infiltrat_rate",
                "is_brd_group_min",
                "is_fj_brb_diff_num",
                "is_diff_brb",
                "is_out_resident_school",
                "is_out_res_2020_new_school",
                "gprs_data_gsm_avg3m",
                "gprs_data_td_avg3m",
                "gprs_data_lte_avg3m",
                "is_low_over_gprs",
                "is_high_over_gprs",
                "avg_over_gprs_fee",
                "aut_exp_fluxpk_opencnt",
                "is_5g_nsa_m_user",
                "is_5g_sa_m_user",
                "is_5g_network",
                "is_down_1g_flux",
                "is_cloud_sdk_user_m",
                "is_8min_6v_user",
                "is_8min_8v_user_m",
                "is_8min_user",
                "is_8min_low_user_m",
                "is_8min_60silent_user_m",
                "basic_voi_saturation",
                "option_voi_saturation",
                "basic_flux_saturation",
                "option_flux_saturation",
                "is_flux_add_3m",
                "addvalue_type_cnt",
                "addvalue_type_fee",
                "is_chng_brand_potential",
                "constellation_m",
                "is_group_paying_m",
                "is_group_broadband_m",
                "is_vip_mems_m",
                "is_gprs_call_satu_low",
                "sum_month",
                "home_city_m",
                "is_innet_multi",
                "is_diff_family_user",
                "is_school_user",
                "is_outnet_mian_two",
                "user_label",
                "change_rate",
                "visited_prob",
                "is_down_100_voice",
                "acall_10086_cnt_3m",
                "acall_comp_hotline_3m",
                "called_comp_hotline_3m",
                "sms_3m_recv_cnt",
                "avg3m_call_dur",
                "comp_obj_proportion",
                "is_called_10088_user",
                "is_touched_10088_user",
                "is_pro_social_network",
                "is_viola_outcall_user",
                "is_harassed_busi_user",
                "is_harassed_com_user",
                "over_vcall_fee",
                "lm3_avg_disfee",
                "avg_3mon_arpu",
                "avg_3mon_mou",
                "avg_3mon_dou",
                "over_gprs_use_fee",
                "is_high_user",
                "personal_discount_income",
                "is_satura_unlimited_user",
                "is_satura_limited_user",
                "is_satura_voice_user",
                "is_unsatura_user",
                "payment_cnt_3m",
                "main_pay_chnl",
                "pay_cnt_m",
                "lowest_sum_fee",
                "is_redeem_user",
                "voc_dur_avg_3m",
                "sms_cnt_avg_3m",
                "flux_avg_3m",
                "dir_flux_avg_3m",
                "is_up_ip_no_global",
                "is_down_100_arpu",
                "is_down_50_arpu",
                "is_itv_active",
                "model",
                "sum_fee_after",
                "basic_fee_after",
                "product_voice_reduce",
                "product_voice_use",
                "brand_gprs_use",
                "product_send_unlimit_gprs",
                "is_fjlive_active_user",
                "next_brand_name",
                "open_flux_product_cnt",
                "open_flux_product_send_gprs",
                "family_account",
                "lost_type",
                "high_lost_type",
                "day_lac_cell",
                "night_lac_cell",
                "is_lowamt_keep",
                "online_boss_lev",
                "biz_code_day",
                "biz_code_night",
                "is_kingcard_sms",
                "pause_cnt_3m",
                "stop_cnt_3m",
                "real_birthday_month",
                "basic_fee_m",
                "is_global_gold_down",
                "is_global_gold_up",
                "is_resident_5g_site",
                "is_lost_global_user",
                "lost_global_value_gap",
                "is_unlimited_basic_user_m",
                "is_5g_basic_package",
                "is_5g_optional_package",
                "is_5g_terminal_m_user",
                "is_5g_tariff_package",
                "is_5g_net_m_user",
                "is_switch_of_5g_m",
                "is_nfc_terminal_m",
                "is_unlimit_rec_user",
                "is_family_rec_user",
                "is_out_friend_user",
                "is_ab_gcus",
                "is_good_number_user",
                "is_high_disc_user",
                "is_differ_net_card",
                "is_differ_net_broad",
                "is_8yuan_low_keep",
                "is_amount_not_saturated",
                "is_sale_user_3m",
                "sale_cnt_acc12m",
                "leatest_sale_name",
                "is_sale_return",
                "is_online_care_user",
                "prediction",
                "is_msisdn_order_user_m",
                "is_basedeal_order_user_m",
                "is_flux_order_user_m",
                "is_add_order_user_m",
                "is_equity_order_user_m",
                "is_cloud_pay_user_m",
                "avg_down_v",
                "avg_up_v",
                "wechat_use_days",
                "taobao_use_days",
                "explorer_call_dur",
                "media_call_dur",
                "game_call_dur",
                "is_video_high_user",
                "is_video_medium_user",
                "is_video_low_user",
                "is_video_high_fre_user",
                "is_video_medium_fre_user",
                "is_video_low_fre_user",
                "is_headlines_high_user",
                "is_headlines_medium_user",
                "is_headlines_low_user",
                "is_headlines_high_fre_user",
                "is_headlines_medium_fre_user",
                "is_headlines_low_fre_user",
                "cloud_app_name",
                "lost_cnt",
                "net_complain_type",
                "query_bill_cnt",
                "complain_cnt",
                "complain_type1",
                "complain_type2",
                "main_chnl_id_m",
                "promotional_score",
                "hotline_score",
                "hall_scores",
                "calls_info_score",
                "ele_channels_score",
                "tariff_score",
                "complaints_score",
                "new_business_score",
                "is_focus_care_user",
                "predprob",
                "complain_cnt_12m",
                "complain_type_latest",
                "is_repeat_complain",
                "new_student_school_name",
                "active_area_type",
                "active_area_scenes",
                "roam_type_3m",
                "is_city_user",
                "is_county_user",
                "is_voice_control",
                "is_somato_devices",
                "is_pay_order",
                "single_point_payment",
                "short_oder",
                "continuous_oder",
                "long_oder",
                "is_history_order",
                "is_past6m_order",
                "is_like_movie",
                "is_like_tv",
                "is_like_show",
                "is_like_sports",
                "is_like_children",
                "is_like_comic",
                "is_like_edu",
                "is_like_life",
                "is_like_ent",
                "is_like_report",
                "itv_active_level",
                "is_itv_reflux",
                "is_itv_down",
                "is_itv_loyal",
                "itv_tidal_type",
                "is_itv_weekend",
                "paying_behavior",
                "pay_channel",
                "is_onscreen_sale",
                "is_offscreen_sale",
                "movie_type",
                "tv_type",
                "is_transform_user",
                "is_children_family",
                "is_older_family",
                "is_edu_family",
                "is_multy_family",
                "is_brb_order_user_m",
                "is_up_pk_next_expire",
                "is_broadband_no_user",
                "is_broadband_pack_user",
                "is_not_bdsale_bduser_m",
                "product_expire_time_m",
                "sale_expire_time_m",
                "broad_product_type_m"};
        String schema = fieldsToAvsc(fields);
        final GenericRecordUtil genericRecordUtil = new GenericRecordUtil(null);
        genericRecordUtil.addTopicBySchemaString(topic, schema);

        try {
            fileUtil.setReader(dataPath);
            fileUtil.read(new FileCount() {
                @Override
                public void run(String content) throws IOException {
                    Map<String, String> dataMap = new HashMap<>();
                    String[] datas = content.split(dataSplit, -1);
                    for (int i = 0; i < fields.length; i++) {
                        dataMap.put(fields[i], datas[i]);
                    }
                    String json = JSONObject.toJSONString(dataMap);
                    byte[] avroData = genericRecordUtil.genericRecord(topic, dataMap);
                    logger.info("标签字段个数：{}，数据字段个数：{}，data（含分隔符）：{} byte，avroData：{} byte，jsonData：{} byte"
                            , fields.length, datas.length, content.length(), avroData.length, json.length());
                }
            });
        } finally {
            fileUtil.closeRead();
        }
    }

    private String fieldsToAvsc(String[] fields) {
        StringBuilder sb = new StringBuilder();
        sb.append("{\"namespace\": \"com.newland.bi.bigdata.bean.avro\",\n");
        sb.append(" \"type\": \"record\",\n");
        sb.append(" \"name\": \"TagCombind\",\n");
        sb.append(" \"fields\": [");
        for (int i = 0; i < fields.length; i++) {
            if (i == fields.length - 1) {
                sb.append(String.format("{\"name\": \"%s\", \"type\": [\"string\", \"null\"]}\n", fields[i]));
            } else {
                sb.append(String.format("{\"name\": \"%s\", \"type\": [\"string\", \"null\"]},\n", fields[i]));
            }
        }
        sb.append(" ]\n");
        sb.append("}");
        return sb.toString();
    }
}
