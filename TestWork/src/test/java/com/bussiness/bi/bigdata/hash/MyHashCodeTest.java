package com.bussiness.bi.bigdata.hash;

import com.bussiness.bi.bigdata.bean.HashCodeFile;
import com.bussiness.bi.bigdata.hash.MyHashCode;
import org.junit.Test;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

public class MyHashCodeTest {

    MyHashCode myHashCode = new MyHashCode(5);

    @Test
    public void printHashCode() {
        // 生产一批对象，周期分布不均匀
        String[] filenames = myHashCode.createFileName(204);
        List<HashCodeFile> hashCodeFileList = myHashCode.createData(filenames);
        // 分组
        Map<Integer, List<HashCodeFile>> modMap = new HashMap<>();
        for (HashCodeFile hashCodeFile : hashCodeFileList) {
            myHashCode.grouping(hashCodeFile, modMap);
        }
        // 查看是否能够平均hash
        myHashCode.printMap(modMap);
        // 查看分区下的数据是否能够平均hash
        String[] bodys = {"20190813120000", "20190813130000", "20190813140000"
                , "20190813150000", "20190813160000", "20190813170000"
                , "20190813180000", "20190813190000", "20190813200000"};
        for (String body : bodys) {
            myHashCode.filterCycle(body, modMap);
        }
    }

    @Test
    public void sc() {
        String[] args = {"A0400220191022114405599482996",
                "A0400220191022115107599483006",
                "A0400220191022115902599483028",
                "A0400220191022133511599483877",
                "A0400220191022135205599484010",
                "A0400220191022135304599484019",
                "A0400220191022140807599483956",
                "A0400220191022142302599484088",
                "A0400220191022152204599484535",
                "A0400220191022152311599484452",
                "A0400220191022153712599484881",
                "A0400220191022150304599484404",
                "A0400220191022153712599484882",
                "A0400220191022151409599484431",
                "A0400220191022161106599485178",
                "A0400220191022165103599485482",
                "A0400220191022160512599485168",
                "A0400220191022160311599485165",
                "A0400220191022160811599485174",
                "A0400220191022172905599485689",
                "A0400220191022171407599485561",
                "A0400220191022174306599485712",
                "A0400220191022174311599485616",
                "A0400220191022184406599486040",
                "A0400220191022185208599486261",
                "A0400220191022185303599486271",
                "A0400220191022181807599485834",
                "A0400220191022181903599485740",
                "A0400220191022181904599485641",
                "A0400220191022182011599485745",
                "A0400220191022182111599485750",
                "A0400220191022182112599485656",
                "A0400220191022182213599485657",
                "A0400220191022183103599485868",
                "A0400220191022183209599486073",
                "A0400220191022183312599485885",
                "A0400220191022183403599485988",
                "A0400220191022181805599485640",
                "A0400220191022182112599485651",
                "A0400220191022182208599485856",
                "A0400220191022182208599485860",
                "A0400220191022183110599486067",
                "A0400220191022183207599485975",
                "A0400220191022183209599486069",
                "A0400220191022183210599485875",
                "A0400220191022183307599485976",
                "A0400220191022183307599485980",
                "A0400220191022183310599486078",
                "A0400220191022183706599486106",
                "A0400220191022183805599486021",
                "A0400220191022184011599486130",
                "A0400220191022184203599486039",
                "A0400220191022184408599486135",
                "A0400220191022184505599486140",
                "A0400220191022184512599486045",
                "A0400220191022184611599485952",
                "A0400220191022184750599485954",
                "A0400220191022185306599486168",
                "A0400220191022185310599486365",
                "A0400220191022185404599486272",
                "A0400220191022185405599486178",
                "A0400220191022185411599486366",
                "A0400220191022185611599486372",
                "A0400220191022185810599486185",
                "A0400220191022185911599486285",
                "A0400220191022184405599485942",
                "A0400220191022184505599485948",
                "A0400220191022184807599486148",
                "A0400220191022184810599486057",
                "A0400220191022185003599485959",
                "A0400220191022185011599486150",
                "A0400220191022185306599486172",
                "A0400220191022185411599486370",
                "A0400220191022185209599486167",
                "A0400220191022185303599486267",
                "A0400220191022185310599486158",
                "A0400220191022185511599486277",
                "A0400220191022181804599485735",
                "A0400220191022182005599485845",
                "A0400220191022182111599485755",
                "A0400220191022184008599486036",
                "A0400220191022183403599485992",
                "A0400220191022183506599485900",
                "A0400220191022183610599486003",
                "A0400220191022183706599486101",
                "A0400220191022183805599486017",
                "A0400220191022183811599485920",
                "A0400220191022183907599486031",
                "A0400220191022183909599485922",
                "A0400220191022182206599485865",
                "A0400220191022183110599486062",
                "A0400220191022183207599485970",
                "A0400220191022183312599485880",
                "A0400220191022183511599486089",
                "A0400220191022183511599486093",
                "A0400220191022183607599486095",
                "A0400220191022183710599485910",
                "A0400220191022183710599486009",
                "A0400220191022183908599486117",
                "A0400220191022183908599486121",
                "A0400220191022183909599485927",
                "A0400220191022182011599485646",
                "A0400220191022182011599485650",
                "A0400220191022182106599485850",
                "A0400220191022182213599485963",
                "A0400220191022183103599485872",
                "A0400220191022183404599485889",
                "A0400220191022183404599485893",
                "A0400220191022183411599486083",
                "A0400220191022183505599485993",
                "A0400220191022183505599485998",
                "A0400220191022183506599485897",
                "A0400220191022183609599485906",
                "A0400220191022183710599485915",
                "A0400220191022183710599486013",
                "A0400220191022183808599486114",
                "A0400220191022183811599485916",
                "A0400220191022183907599486027",
                "A0400220191022184003599485934",
                "A0400220191022184008599486037",
                "A0400220191022184011599486126",
                "A0400220191022194811599486705",
                "A0400220191022195207599486531",
                "A0400220191022195303599486721",
                "A0400220191022192205599486440",
                "A0400220191022195304599486537",
                "A0400220191022195504599486543",
                "A0400220191022195605599486544",
                "A0400220191022192213599486250",
                "A0400220191022192310599486355",
                "A0400220191022192804599486565",
                "A0400220191022192905599486467",
                "A0400220191022193108599486469",
                "A0400220191022194107599486498",
                "A0400220191022194208599486499",
                "A0400220191022194405599486699",
                "A0400220191022194810599486520",
                "A0400220191022195206599486716",
                "A0400220191022195207599486527",
                "A0400220191022192803599486466",
                "A0400220191022193111599486459",
                "A0400220191022194208599486502",
                "A0400220191022190303599486205",
                "A0400220191022190304599486296",
                "A0400220191022190304599486304",
                "A0400220191022190607599486212",
                "A0400220191022190709599486213",
                "A0400220191022191005599486315",
                "A0400220191022191208599486222",
                "A0400220191022191208599486321",
                "A0400220191022191305599486329",
                "A0400220191022191311599486416",
                "A0400220191022194305599486508",
                "A0400220191022194306599486693",
                "A0400220191022194306599486698",
                "A0400220191022194307599486607",
                "A0400220191022195209599486626",
                "A0400220191022195303599486726",
                "A0400220191022195304599486532",
                "A0400220191022195306599486636",
                "A0400220191022195909599486736",
                "A0400220191022192212599486345",
                "A0400220191022192409599486451",
                "A0400220191022192703599486564",
                "A0400220191022193006599486468",
                "A0400220191022193209599486474",
                "A0400220191022193308599486669",
                "A0400220191022193308599486673",
                "A0400220191022194209599486601",
                "A0400220191022194508599486613",
                "A0400220191022194911599486521",
                "A0400220191022195105599486710",
                "A0400220191022195206599486711",
                "A0400220191022195412599486542",
                "A0400220191022195610599486642",
                "A0400220191022195706599486545",
                "A0400220191022192103599486430",
                "A0400220191022192111599486344",
                "A0400220191022192205599486436",
                "A0400220191022190105599486190",
                "A0400220191022190204599486385",
                "A0400220191022190207599486194",
                "A0400220191022190208599486289",
                "A0400220191022190208599486293",
                "A0400220191022190303599486197",
                "A0400220191022190303599486200",
                "A0400220191022190311599486388",
                "A0400220191022190311599486392",
                "A0400220191022190404599486305",
                "A0400220191022190408599486394",
                "A0400220191022191203599486409",
                "A0400220191022191303599486225",
                "A0400220191022191703599486238",
                "A0400220191022191704599486337",
                "A0400220191022192011599486429",
                "A0400220191022192309599486252",
                "A0400220191022193209599486479",
                "A0400220191022193212599486662",
                "A0400220191022193407599486674",
                "A0400220191022193702599486679",
                "A0400220191022194209599486598",
                "A0400220191022195306599486631",
                "A0400220191022195804599486645",
                "A0400220191022195807599486546",
                "A0400220191022192213599486246",
                "A0400220191022192309599486257",
                "A0400220191022192312599486445",
                "A0400220191022193209599486573",
                "A0400220191022193307599486484",
                "A0400220191022193307599486579",
                "A0400220191022193307599486583",
                "A0400220191022193710599486491",
                "A0400220191022193811599486492",
                "A0400220191022193912599486493",
                "A0400220191022194209599486688",
                "A0400220191022194305599486512",
                "A0400220191022204809599487171",
                "A0400220191022203410599486952",
                "A0400220191022200016599486738",
                "A0400220191022200209599486553",
                "A0400220191022200210599486651",
                "A0400220191022200210599486741",
                "A0400220191022200304599486747",
                "A0400220191022200903599486815",
                "A0400220191022201906599486862",
                "A0400220191022202308599486896",
                "A0400220191022203207599486941",
                "A0400220191022203207599487017",
                "A0400220191022203302599486942",
                "A0400220191022202308599486904",
                "A0400220191022202308599487002",
                "A0400220191022202309599486837",
                "A0400220191022202309599486841",
                "A0400220191022202811599487010",
                "A0400220191022202912599487011",
                "A0400220191022203005599486921",
                "A0400220191022203207599486937",
                "A0400220191022203302599486947",
                "A0400220191022203302599487022",
                "A0400220191022203302599487027",
                "A0400220191022203305599486875",
                "A0400220191022203410599486951",
                "A0400220191022203412599486884",
                "A0400220191022203503599486953",
                "A0400220191022204010599487037",
                "A0400220191022204103599487063",
                "A0400220191022204111599487038",
                "A0400220191022204204599487064",
                "A0400220191022200209599486558",
                "A0400220191022200306599486658",
                "A0400220191022200306599486789",
                "A0400220191022201105599486964",
                "A0400220191022201311599486834",
                "A0400220191022201311599486843",
                "A0400220191022201311599486848",
                "A0400220191022202407599486847",
                "A0400220191022202507599486910",
                "A0400220191022202609599486911",
                "A0400220191022202610599486857",
                "A0400220191022202803599486859",
                "A0400220191022200108599486552",
                "A0400220191022200810599486760",
                "A0400220191022201003599486963",
                "A0400220191022201207599486776",
                "A0400220191022201312599486794",
                "A0400220191022200304599486751",
                "A0400220191022200306599486761",
                "A0400220191022201312599486780",
                "A0400220191022201312599486974",
                "A0400220191022201408599486980",
                "A0400220191022201411599486849",
                "A0400220191022201807599486808",
                "A0400220191022202109599486989",
                "A0400220191022202211599486894",
                "A0400220191022202212599486993",
                "A0400220191022200404599486793",
                "A0400220191022204306599487079",
                "A0400220191022204607599487167",
                "A0400220191022204711599487059",
                "A0400220191022205012599487089",
                "A0400220191022205208599487267",
                "A0400220191022204204599487069",
                "A0400220191022204207599486925",
                "A0400220191022204212599487043",
                "A0400220191022204306599487074",
                "A0400220191022204308599487047",
                "A0400220191022204411599487164",
                "A0400220191022204503599487166",
                "A0400220191022204809599487169",
                "A0400220191022205005599487262",
                "A0400220191022205205599487098",
                "A0400220191022205206599487179",
                "A0400220191022205707599487282",
                "A0400220191022204212599487039",
                "A0400220191022204709599487168",
                "A0400220191022205205599487093",
                "A0400220191022205312599487190",
                "A0400220191022205505599487280",
                "A0400220191022204308599487051",
                "A0400220191022205206599487183",
                "A0400220191022205304599487274",
                "A0400220191022205312599487104",
                "A0400220191022205312599487186",
                "A0400220191022205606599487281",
                "A0400220191022205906599487199",
                "A0400220191022215203599487444",
                "A0400220191022215211599487522",
                "A0400220191022215306599487533",
                "A0400220191022215310599487622",
                "A0400220191022214112599487498",
                "A0400220191022215308599487448",
                "A0400220191022215310599487618",
                "A0400220191022215308599487452",
                "A0400220191022215407599487458",
                "A0400220191022210204599487291",
                "A0400220191022210305599487210",
                "A0400220191022211108599487139",
                "A0400220191022211313599487237",
                "A0400220191022211402599487330",
                "A0400220191022211706599487333",
                "A0400220191022211807599487334",
                "A0400220191022212610599487388",
                "A0400220191022213005599487394",
                "A0400220191022213107599487395",
                "A0400220191022213207599487567",
                "A0400220191022213303599487482",
                "A0400220191022213303599487487",
                "A0400220191022213304599487572",
                "A0400220191022213304599487577",
                "A0400220191022213312599487399",
                "A0400220191022213312599487402",
                "A0400220191022213411599487408",
                "A0400220191022210011599487117",
                "A0400220191022210204599487296",
                "A0400220191022210211599487204",
                "A0400220191022210407599487306",
                "A0400220191022210609599487308",
                "A0400220191022211006599487138",
                "A0400220191022211304599487154",
                "A0400220191022211305599487325",
                "A0400220191022211503599487331",
                "A0400220191022210305599487215",
                "A0400220191022210309599487125",
                "A0400220191022210802599487309",
                "A0400220191022210912599487224",
                "A0400220191022211604599487332",
                "A0400220191022212110599487250",
                "A0400220191022212203599487371",
                "A0400220191022212212599487251",
                "A0400220191022212308599487462",
                "A0400220191022212309599487377",
                "A0400220191022212309599487381",
                "A0400220191022212406599487355",
                "A0400220191022212406599487468",
                "A0400220191022212407599487387",
                "A0400220191022211209599487144",
                "A0400220191022212202599487344",
                "A0400220191022212212599487256",
                "A0400220191022212609599487357",
                "A0400220191022212711599487389",
                "A0400220191022213005599487475",
                "A0400220191022213005599487565",
                "A0400220191022213106599487476",
                "A0400220191022213207599487477",
                "A0400220191022213910599487414",
                "A0400220191022213910599487586",
                "A0400220191022214309599487504",
                "A0400220191022214310599487602",
                "A0400220191022214311599487427",
                "A0400220191022214409599487604",
                "A0400220191022215204599487615",
                "A0400220191022215306599487529",
                "A0400220191022214204599487500",
                "A0400220191022214204599487591",
                "A0400220191022214309599487509",
                "A0400220191022214310599487599",
                "A0400220191022214511599487433",
                "A0400220191022214612599487434",
                "A0400220191022224810599487850",
                "A0400220191022225205599487857",
                "A0400220191022225212599487978",
                "A0400220191022225308599487948",
                "A0400220191022225902599488071",
                "A0400220191022224810599487940",
                "A0400220191022225204599487947",
                "A0400220191022225309599488064",
                "A0400220191022225506599487990",
                "A0400220191022225607599487991",
                "A0400220191022225708599487992",
                "A0400220191022225810599488162",
                "A0400220191022225911599488163",
                "A0400220191022224307599487842",
                "A0400220191022224309599487932",
                "A0400220191022225308599487952",
                "A0400220191022220311599487679",
                "A0400220191022220904599487685",
                "A0400220191022221006599487688",
                "A0400220191022221303599487861",
                "A0400220191022221311599487697",
                "A0400220191022221311599487700",
                "A0400220191022221603599487873",
                "A0400220191022221612599487703",
                "A0400220191022222005599487784",
                "A0400220191022222008599487877",
                "A0400220191022222208599487789",
                "A0400220191022222209599487711",
                "A0400220191022222211599487882",
                "A0400220191022222311599487793",
                "A0400220191022223602599487827",
                "A0400220191022224209599487832",
                "A0400220191022220102599487542",
                "A0400220191022220410599487648",
                "A0400220191022220711599487560",
                "A0400220191022221303599487866",
                "A0400220191022221311599487692",
                "A0400220191022220204599487548",
                "A0400220191022220208599487638",
                "A0400220191022220303599487643",
                "A0400220191022220309599487549",
                "A0400220191022220309599487553",
                "A0400220191022220311599487674",
                "A0400220191022220409599487680",
                "A0400220191022220703599487683",
                "A0400220191022221209599487660",
                "A0400220191022221303599487771",
                "A0400220191022221303599487776",
                "A0400220191022221409599487777",
                "A0400220191022221805599487875",
                "A0400220191022222302599487719",
                "A0400220191022222306599487886",
                "A0400220191022222306599487890",
                "A0400220191022222311599487801",
                "A0400220191022223005599487810",
                "A0400220191022223107599487811",
                "A0400220191022223208599487731",
                "A0400220191022221207599487766",
                "A0400220191022222302599487714",
                "A0400220191022222311599487798",
                "A0400220191022222409599487722",
                "A0400220191022223208599487812",
                "A0400220191022223211599487901",
                "A0400220191022223311599487736",
                "A0400220191022223311599487740",
                "A0400220191022223409599487823",
                "A0400220191022224107599487750",
                "A0400220191022224107599487831",
                "A0400220191022224204599487922",
                "A0400220191022224204599487927",
                "A0400220191022224208599487756",
                "A0400220191022224307599487964",
                "A0400220191022225306599487984",
                "A0400220191022225406599487958",
                "A0400220191022225406599488065",
                "A0400220191022225507599487959",
                "A0400220191022225809599487993",
                "A0400220191022224307599487838",
                "A0400220191022224309599487928",
                "A0400220191022224405599487967",
                "A0400220191022235303599488299",
                "A0400220191022235411599488307",
                "A0400220191022233406599488151",
                "A0400220191022234104599488245",
                "A0400220191022234308599488251",
                "A0400220191022234309599488283",
                "A0400220191022234309599488288",
                "A0400220191022234310599488363",
                "A0400220191022235210599488378",
                "A0400220191022235211599488297",
                "A0400220191022235410599488389",
                "A0400220191022235411599488474",
                "A0400220191022235908599488312",
                "A0400220191022230111599487995",
                "A0400220191022230212599487996",
                "A0400220191022230307599488002",
                "A0400220191022230309599488087",
                "A0400220191022230911599488183",
                "A0400220191022231310599488100",
                "A0400220191022231406599488028",
                "A0400220191022231509599488031",
                "A0400220191022231906599488113",
                "A0400220191022232207599488206",
                "A0400220191022232305599488121",
                "A0400220191022232910599488135",
                "A0400220191022233109599488225",
                "A0400220191022233203599488140",
                "A0400220191022233303599488233",
                "A0400220191022233307599488141",
                "A0400220191022230003599488072",
                "A0400220191022230104599488073",
                "A0400220191022230205599488079",
                "A0400220191022230306599488174",
                "A0400220191022230307599488007",
                "A0400220191022230810599488182",
                "A0400220191022230811599488092",
                "A0400220191022231203599488017",
                "A0400220191022231205599488189",
                "A0400220191022231206599488097",
                "A0400220191022230012599488164",
                "A0400220191022230205599488074",
                "A0400220191022230609599488091",
                "A0400220191022231013599488094",
                "A0400220191022231013599488184",
                "A0400220191022231307599488025",
                "A0400220191022231310599488105",
                "A0400220191022231310599488191",
                "A0400220191022231408599488198",
                "A0400220191022231510599488201",
                "A0400220191022231811599488033",
                "A0400220191022232007599488114",
                "A0400220191022232108599488115",
                "A0400220191022230309599488082",
                "A0400220191022231310599488196",
                "A0400220191022231409599488107",
                "A0400220191022232106599488205",
                "A0400220191022232305599488126",
                "A0400220191022232308599488040",
                "A0400220191022232308599488045",
                "A0400220191022232311599488210",
                "A0400220191022232311599488215",
                "A0400220191022232409599488217",
                "A0400220191022232412599488130",
                "A0400220191022232511599488050",
                "A0400220191022233302599488265",
                "A0400220191022233303599488229",
                "A0400220191022233403599488239",
                "A0400220191022234204599488278",
                "A0400220191022234205599488246",
                "A0400220191022234207599488160",
                "A0400220191022234412599488256",
                "A0400220191022235212599488464",
                "A0400220191022235303599488302",
                "A0400220191022233307599488146",
                "A0400220191022233403599488270",
                "A0400220191022234402599488290",
                "A0400220191022235302599488384"};
        Map<Integer, List<HashCodeFile>> modMap = new HashMap<>();
        for (String arg : args) {
            HashCodeFile hashCodeFile = new HashCodeFile(arg, "");
            myHashCode.grouping(hashCodeFile, modMap);
        }
        // 查看是否能够平均hash
        myHashCode.printMap(modMap);
    }

    @Test
    public void nameTest() {
        String name1 = "Uar_64_41_ip_session_60_20191031_165000_20191031_165059.csv";
        String name2 = "Uar_64_41_voip_session_60_20191031_165300_20191031_165359_2.csv";
        System.out.println(name1+"，contains：_ip_session："+name1.contains("_ip_session"));
        System.out.println(name2+"，contains：_ip_session："+name2.contains("_ip_session"));
        System.out.println(name1+"，contains：_voip_session："+name1.contains("_voip_session"));
        System.out.println(name2+"，contains：_voip_session："+name2.contains("_voip_session"));
    }
}